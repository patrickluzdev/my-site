
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                BigInt             @id @default(autoincrement())
  name              String
  email             String             @unique
  emailVerifiedAt   DateTime?          @map("email_verified_at")
  passwordHash      String?            @map("password_hash")
  avatarUrl         String?            @map("avatar_url")
  bio               String?
  role              String             @default("user")
  isActive          Boolean            @default(true) @map("is_active")
  createdAt         DateTime           @default(now()) @map("created_at")
  updatedAt         DateTime           @updatedAt @map("updated_at")

  socialAccounts    SocialAccount[]
  posts             Post[]
  comments          Comment[]
  postLikes         PostLike[]
  commentLikes      CommentLike[]

  @@map("users")
}

model SocialAccount {
  id              BigInt    @id @default(autoincrement())
  userId          BigInt    @map("user_id")
  provider        String
  providerUserId  String    @map("provider_user_id")
  providerEmail   String?   @map("provider_email")
  accessToken     String?   @map("access_token")
  refreshToken    String?   @map("refresh_token")
  expiresAt       DateTime? @map("expires_at")
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerUserId])
  @@map("social_accounts")
}

model PostCategory {
  id           Int      @id @default(autoincrement())
  name         String   @unique
  slug         String   @unique
  description  String?
  color        String?
  icon         String?
  displayOrder Int      @default(0) @map("display_order")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  posts Post[]

  @@map("post_categories")
}

model Post {
  id            BigInt        @id @default(autoincrement())
  authorId      BigInt        @map("author_id")
  categoryId    Int?          @map("category_id")
  title         String
  slug          String        @unique
  description   String?
  content       String
  thumbnailUrl  String?       @map("thumbnail_url")
  badge         String?
  isPinned      Boolean       @default(false) @map("is_pinned")
  isPublished   Boolean       @default(false) @map("is_published")
  viewsCount    Int           @default(0) @map("views_count")
  likesCount    Int           @default(0) @map("likes_count")
  commentsCount Int           @default(0) @map("comments_count")
  publishedAt   DateTime?     @map("published_at")
  createdAt     DateTime      @default(now()) @map("created_at")
  updatedAt     DateTime      @updatedAt @map("updated_at")

  author   User          @relation(fields: [authorId], references: [id], onDelete: Cascade)
  category PostCategory? @relation(fields: [categoryId], references: [id], onDelete: SetNull)
  comments Comment[]
  likes    PostLike[]

  @@map("posts")
}

model Comment {
  id              BigInt    @id @default(autoincrement())
  postId          BigInt    @map("post_id")
  userId          BigInt?   @map("user_id")
  parentCommentId BigInt?   @map("parent_comment_id")
  authorName      String?   @map("author_name")
  authorEmail     String?   @map("author_email")
  content         String
  isApproved      Boolean   @default(false) @map("is_approved")
  likesCount      Int       @default(0) @map("likes_count")
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  post          Post           @relation(fields: [postId], references: [id], onDelete: Cascade)
  user          User?          @relation(fields: [userId], references: [id], onDelete: SetNull)
  parentComment Comment?       @relation("CommentReplies", fields: [parentCommentId], references: [id], onDelete: Cascade)
  replies       Comment[]      @relation("CommentReplies")
  likes         CommentLike[]

  @@map("comments")
}

model PostLike {
  id        BigInt   @id @default(autoincrement())
  postId    BigInt   @map("post_id")
  userId    BigInt?  @map("user_id")
  ipAddress String?  @map("ip_address")
  createdAt DateTime @default(now()) @map("created_at")

  post Post  @relation(fields: [postId], references: [id], onDelete: Cascade)
  user User? @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([postId, userId])
  @@unique([postId, ipAddress])
  @@map("post_likes")
}

model CommentLike {
  id        BigInt   @id @default(autoincrement())
  commentId BigInt   @map("comment_id")
  userId    BigInt?  @map("user_id")
  ipAddress String?  @map("ip_address")
  createdAt DateTime @default(now()) @map("created_at")

  comment Comment @relation(fields: [commentId], references: [id], onDelete: Cascade)
  user    User?   @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([commentId, userId])
  @@unique([commentId, ipAddress])
  @@map("comment_likes")
}

model ProjectCategory {
  id           Int      @id @default(autoincrement())
  name         String   @unique
  slug         String   @unique
  description  String?
  icon         String?
  displayOrder Int      @default(0) @map("display_order")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  projects Project[]

  @@map("project_categories")
}

model Technology {
  id        Int      @id @default(autoincrement())
  name      String   @unique
  slug      String   @unique
  iconUrl   String?  @map("icon_url")
  category  String?
  color     String?
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  projects ProjectTechnology[]

  @@map("technologies")
}

model Project {
  id               BigInt    @id @default(autoincrement())
  categoryId       Int?      @map("category_id")
  title            String
  slug             String    @unique
  description      String
  content          String?
  imageUrl         String?   @map("image_url")
  status           String    @default("em-desenvolvimento")
  isFeatured       Boolean   @default(false) @map("is_featured")
  demoUrl          String?   @map("demo_url")
  githubUrl        String?   @map("github_url")
  caseStudyUrl     String?   @map("case_study_url")
  starsCount       Int       @default(0) @map("stars_count")
  usersCount       String?   @map("users_count")
  performanceScore String?   @map("performance_score")
  displayOrder     Int       @default(0) @map("display_order")
  createdAt        DateTime  @default(now()) @map("created_at")
  updatedAt        DateTime  @updatedAt @map("updated_at")

  category     ProjectCategory?     @relation(fields: [categoryId], references: [id], onDelete: SetNull)
  technologies ProjectTechnology[]
  images       ProjectImage[]
  clients      Client[]

  @@map("projects")
}

model ProjectTechnology {
  id           BigInt   @id @default(autoincrement())
  projectId    BigInt   @map("project_id")
  technologyId Int      @map("technology_id")
  displayOrder Int      @default(0) @map("display_order")
  createdAt    DateTime @default(now()) @map("created_at")

  project    Project    @relation(fields: [projectId], references: [id], onDelete: Cascade)
  technology Technology @relation(fields: [technologyId], references: [id], onDelete: Cascade)

  @@unique([projectId, technologyId])
  @@map("project_technologies")
}

model ProjectImage {
  id           BigInt   @id @default(autoincrement())
  projectId    BigInt   @map("project_id")
  imageUrl     String   @map("image_url")
  caption      String?
  displayOrder Int      @default(0) @map("display_order")
  isCover      Boolean  @default(false) @map("is_cover")
  createdAt    DateTime @default(now()) @map("created_at")

  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@map("project_images")
}

model Client {
  id           BigInt   @id @default(autoincrement())
  projectId    BigInt?  @map("project_id")
  name         String
  companyName  String?  @map("company_name")
  companyType  String?  @map("company_type")
  initial      String?
  avatarColor  String?  @map("avatar_color")
  emoji        String?
  testimonial  String?
  rating       Decimal? @db.Decimal(2, 1)
  isFeatured   Boolean  @default(false) @map("is_featured")
  displayOrder Int      @default(0) @map("display_order")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  project Project? @relation(fields: [projectId], references: [id], onDelete: SetNull)

  @@map("clients")
}

model ContactMessage {
  id        BigInt    @id @default(autoincrement())
  name      String
  email     String
  subject   String?
  message   String
  ipAddress String?   @map("ip_address")
  userAgent String?   @map("user_agent")
  status    String    @default("new")
  readAt    DateTime? @map("read_at")
  repliedAt DateTime? @map("replied_at")
  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime  @updatedAt @map("updated_at")

  @@map("contact_messages")
}

model NewsletterSubscription {
  id                BigInt    @id @default(autoincrement())
  email             String    @unique
  name              String?
  status            String    @default("active")
  ipAddress         String?   @map("ip_address")
  verificationToken String?   @map("verification_token")
  verifiedAt        DateTime? @map("verified_at")
  unsubscribedAt    DateTime? @map("unsubscribed_at")
  createdAt         DateTime  @default(now()) @map("created_at")
  updatedAt         DateTime  @updatedAt @map("updated_at")

  @@map("newsletter_subscriptions")
}

model Skill {
  id              Int      @id @default(autoincrement())
  name            String
  category        String
  proficiencyLevel Int     @default(5) @map("proficiency_level")
  icon            String?
  displayOrder    Int      @default(0) @map("display_order")
  createdAt       DateTime @default(now()) @map("created_at")
  updatedAt       DateTime @updatedAt @map("updated_at")

  @@map("skills")
}

model WorkExperience {
  id             Int       @id @default(autoincrement())
  companyName    String    @map("company_name")
  position       String
  location       String?
  employmentType String?   @map("employment_type")
  description    String?
  startDate      DateTime  @map("start_date")
  endDate        DateTime? @map("end_date")
  isCurrent      Boolean   @default(false) @map("is_current")
  displayOrder   Int       @default(0) @map("display_order")
  createdAt      DateTime  @default(now()) @map("created_at")
  updatedAt      DateTime  @updatedAt @map("updated_at")

  @@map("work_experiences")
}

model Education {
  id              Int       @id @default(autoincrement())
  institutionName String    @map("institution_name")
  degree          String
  fieldOfStudy    String    @map("field_of_study")
  location        String?
  description     String?
  startDate       DateTime  @map("start_date")
  endDate         DateTime? @map("end_date")
  isCurrent       Boolean   @default(false) @map("is_current")
  displayOrder    Int       @default(0) @map("display_order")
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  @@map("education")
}

model SiteSetting {
  id          Int      @id @default(autoincrement())
  key         String   @unique
  value       String?
  type        String   @default("string")
  description String?
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@map("site_settings")
}
